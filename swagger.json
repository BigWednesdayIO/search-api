{
    "swagger": "2.0",
    "info": {
        "version": "1.0.0",
        "title": "Search API"
    },
    "basePath": "/1",
    "paths": {
        "/indexes": {
            "get": {
                "description": "List all `Index` objects.\n",
                "responses": {
                    "200": {
                        "description": "An array of indexes",
                        "schema": {
                            "type": "array",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "name": {
                                        "type": "string",
                                        "description": "Unique index name"
                                    },
                                    "createdAt": {
                                        "type": "string",
                                        "description": "An ISO 8061 formatted date string for when the index was created"
                                    },
                                    "updatedAt": {
                                        "type": "string",
                                        "description": "An ISO 8061 formatted date string for when the index was last updated"
                                    },
                                    "entries": {
                                        "type": "integer",
                                        "format": "int32",
                                        "description": "Number of records contained within the index"
                                    },
                                    "pendingTask": {
                                        "type": "boolean",
                                        "description": "An update task is currently running"
                                    },
                                    "lastBuildTimeS": {
                                        "type": "integer",
                                        "format": "int32",
                                        "description": "Time taken to build the index"
                                    },
                                    "dataSize": {
                                        "type": "integer",
                                        "format": "int32",
                                        "description": "Size of the data held within the index"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/indexes/{name}": {
            "post": {
                "description": "Add an object to the index and automatically assign an identifier.\n",
                "responses": {
                    "201": {
                        "description": "The indexed document containing the automatically generated id and supplied fields",
                        "schema": {
                            "type": "object"
                        }
                    }
                }
            },
            "delete": {
                "description": "Deletes an index.\n",
                "responses": {
                    "204": {
                        "description": "Index deleted"
                    }
                }
            },
            "parameters": [
                {
                    "name": "name",
                    "in": "path",
                    "description": "Name of the index in which to create the object",
                    "required": true,
                    "type": "string"
                }
            ]
        },
        "/indexes/{name}/settings": {
            "put": {
                "description": "Replace the settings for an index.\n",
                "responses": {
                    "200": {
                        "description": "Settings saved"
                    }
                }
            },
            "get": {
                "description": "Get settings from the index.\n",
                "responses": {
                    "200": {
                        "description": "Settings"
                    }
                }
            },
            "parameters": [
                {
                    "name": "name",
                    "in": "path",
                    "description": "Name of the index to replace settings on",
                    "required": true,
                    "type": "string"
                }
            ]
        },
        "/indexes/{name}/{objectID}": {
            "delete": {
                "description": "Delete an object by it's identifier.\n",
                "responses": {
                    "204": {
                        "description": "Object deleted"
                    }
                }
            },
            "get": {
                "description": "Get an object by it's identifier.\n",
                "responses": {
                    "200": {
                        "description": "The identified object",
                        "schema": {
                            "type": "object"
                        }
                    },
                    "404": {
                        "description": "The object was not found",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            },
            "put": {
                "description": "Create or replace an object in the index.\n",
                "responses": {
                    "201": {
                        "description": "The object created in the index.",
                        "schema": {
                            "type": "object"
                        }
                    },
                    "200": {
                        "description": "The object that has replaced another in the index.",
                        "schema": {
                            "type": "object"
                        }
                    }
                }
            },
            "parameters": [
                {
                    "name": "name",
                    "in": "path",
                    "description": "Name of the index to search",
                    "required": true,
                    "type": "string"
                },
                {
                    "name": "objectID",
                    "in": "path",
                    "description": "The identifier of the object to delete",
                    "required": true,
                    "type": "string"
                }
            ]
        },
        "/indexes/{name}/query": {
            "post": {
                "description": "Performs a search on an index\n",
                "responses": {
                    "200": {
                        "description": "Search results",
                        "schema": {
                            "type": "array",
                            "items": {
                                "type": "object"
                            }
                        }
                    }
                },
                "parameters": [
                    {
                        "name": "name",
                        "in": "path",
                        "description": "Name of the index to query",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "params",
                        "in": "body",
                        "description": "The search query",
                        "required": true,
                        "schema": {
                            "type": "object",
                            "properties": {
                                "query": {
                                    "type": "string",
                                    "description": "Search keywords"
                                },
                                "filters": {
                                    "type": "array",
                                    "description": "An array of search filter objects. Either 'term' or 'range' is required",
                                    "items": {
                                        "type": "object",
                                        "minProperties": 2,
                                        "maxProperties": 2,
                                        "required": ["field"],
                                        "properties": {
                                            "field": {
                                                "type": "string",
                                                "description": "The field to filter by"
                                            },
                                            "term": {
                                                "type": "string",
                                                "description": "The filter term"
                                            },
                                            "range": {
                                                "type": "object",
                                                "description": "The filter range",
                                                "minProperties": 1,
                                                "properties": {
                                                    "from": {
                                                        "type": "number",
                                                        "description": "The range's lower bound"
                                                    },
                                                    "to": {
                                                        "type": "number",
                                                        "description": "The range's upper bound"
                                                    }
                                                }
                                            }
                                        }
                                    }
                                },
                                "page": {
                                    "type": "integer",
                                    "description": "Page of results to return"
                                },
                                "hitsPerPage": {
                                    "type": "integer",
                                    "description": "Number of hits per page"
                                },
                                "sort": {
                                    "type": "array",
                                    "description": "An array of sort options",
                                    "items": {
                                        "type": "object",
                                        "description": "A sort object. If direction is emitted it defaults to asc",
                                        "required": ["field"],
                                        "properties": {
                                            "field": {
                                                "type": "string",
                                                "description": "Field to sort on"
                                            },
                                            "direction": {
                                                "type": "string",
                                                "description": "Sort direction",
                                                "enum": ["asc", "desc"]
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                ]
            }
        },
        "/indexes/{indexName}/task/{taskID}": {
            "get": {
                "description": "Get details of an indexing task.\n",
                "responses": {
                    "200": {
                        "description": "Task found",
                        "schema": {
                            "type": "object",
                            "properties": {
                                "status": {
                                    "type": "string",
                                    "description": "The status of the task (published or notPublished)"
                                },
                                "pendingTask": {
                                    "type": "boolean",
                                    "description": "Indicates whether the index has remaining tasks running"
                                }
                            }
                        }
                    }
                },
                "parameters": [
                    {
                        "name": "indexName",
                        "in": "path",
                        "description": "Name of the index containing the task",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "taskID",
                        "in": "path",
                        "description": "The identifier of the task",
                        "type": "integer",
                        "format": "int32",
                        "required": true
                    }
                ]
            }
        }
    },
    "definitions": {
        "Task": {
            "type": "object",
            "properties": {
                "createdAt": {
                    "type": "string",
                    "description": "An ISO 8061 formatted date string"
                },
                "taskID": {
                    "type": "integer",
                    "format": "int32",
                    "description": "Identifier of the indexing task"
                },
                "objectID": {
                    "type": "string",
                    "description": "The identifier of the object being indexed"
                }
            }
        },
        "Error": {
            "type": "object",
            "properties": {
                "message": {
                    "type": "string",
                    "description": "A message explaining the error"
                },
                "error": {
                    "type": "string",
                    "description": "An error message"
                },
                "statusCode": {
                    "type": "integer",
                    "format": "int32",
                    "description": "An HTTP status code"
                }
            }
        }
    }
}
